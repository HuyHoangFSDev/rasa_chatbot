<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Chatbot</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://kit.fontawesome.com/a076d05399.js"></script>
    <style>
      body {
        font-family: Arial, sans-serif;
        margin: 0;
        padding: 0;
        background-color: #f9f9f9;
      }
      .container {
        max-width: 800px;
        margin: 0 auto;
        padding: 20px;
      }
      h1 {
        text-align: center;
        margin-bottom: 30px;
        font-weight: bold;
      }
      .chat-sign-button {
        width: 50px;
        height: 50px;
        font-size: 24px;
      }
      #chat-widget {
        position: fixed;
        bottom: 100px;
        right: 20px;
        width: 300px;
        display: none;
        background-color: #fff;
        border: 1px solid #ccc;
        border-radius: 5px;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      }
      .chat-header {
        background-color: #007bff;
        color: #fff;
        padding: 10px;
        border-top-left-radius: 5px;
        border-top-right-radius: 5px;
        position: relative;
      }
      .chat-header .close-button {
        position: absolute;
        top: 50%;
        right: 10px;
        transform: translateY(-50%);
        background: none;
        border: none;
        color: #fff;
        font-size: 18px;
        cursor: pointer;
      }
      .chat-body {
        padding: 10px;
        max-height: 300px;
        overflow-y: auto;
      }
      .chat-input {
        padding: 10px;
        border-top: 1px solid #ccc;
      }
      .chat-input input {
        width: calc(100% - 20px);
        border: none;
        outline: none;
        padding: 5px;
        border-radius: 5px;
      }
      img {
        max-width: 100%;
        border-radius: 10px;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        margin-bottom: 20px;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <h1>
        <span style="font-weight: bold; color: #f37423"
          >Chào mừng đến với chatbot của sinh viên</span
        >
        <span style="font-weight: bold; color: #000080"> trường DNU!</span>
      </h1>
      <img
        src="https://dainam.edu.vn/admin/upload/logo/8tedlgbzwga59lkxpcq120200504091307_thump.png"
      />
      <button
        id="chat-widget-button"
        type="button"
        class="btn btn-primary rounded-circle position-fixed chat-sign-button"
        style="bottom: 20px; right: 20px"
      >
      +
      </button>
      <div id="chat-widget" class="card" style="display: none">
        <div class="chat-header">
          Chabot DNU
          <button
            id="chat-widget-close-button"
            type="button"
            class="close-button"
          >
            ×
          </button>
        </div>
        <div class="chat-body" id="chat-widget-messages"></div>
        <div class="chat-input">
          <input
            type="text"
            class="form-control"
            id="chat-widget-input"
            placeholder="Nhập tin nhắn..."
          />
        </div>
      </div>
    </div>
    <script>
      $(document).ready(function () {
        $("#chat-widget-button").on("click", function () {
          $("#chat-widget").toggle();
        });

        $("#chat-widget-close-button").on("click", function () {
          $("#chat-widget").hide();
        });

        $("#chat-widget-input").keypress(function (event) {
          if (event.which == 13) {
            let userMessage = $("#chat-widget-input").val();
            $("#chat-widget-input").val("");

            $("#chat-widget-messages").append(
              "<div><strong>Bạn: </strong> " + userMessage + "</div>"
            );

            $.ajax({
              type: "POST",
              url: "/webhook",
              contentType: "application/json",
              data: JSON.stringify({ message: userMessage }),
              success: function (data) {
                console.log(data);
                let botResponse = data.response;
                $("#chat-widget-messages").append(
                  "<div><strong>Bot: </strong> " + botResponse + "</div>"
                );
              },
              error: function () {
                // Xử lý lỗi nếu cần
              },
            });
          }
        });
      });
    </script>
  </body>
</html>
